        <%ST(A)%>
			<div id="Content_ContentList" class="content-width"><a name="body" accesskey="B" href="#body"></a>
				<div class="pageContent">
					<div style="float:right;width:180px !important;width:auto"><a href="?id=90" title="上一篇日志: 郁闷，动网论坛设置发送邮件，都用了两个小时" accesskey=","><img border="0" src="images/Cprevious.gif" alt=""/>上一篇</a> | <a href="?id=92" title="下一篇日志: [人在北京]总算有网上了" accesskey="."><img border="0" src="images/Cnext.gif" alt=""/>下一篇</a></div> 
					<img src="images/icons/21.gif" style="margin:0px 2px -4px 0px" alt=""/> <strong><a href="default.asp?cateID=26" title="查看所有作品的日志">作品</a></strong> <a href="feed.asp?cateID=26" target="_blank" title="订阅所有作品的日志" accesskey="O"><img border="0" src="images/rss.png" alt="订阅所有作品的日志" style="margin-bottom:-1px"/></a>
				</div>
				<div class="Content">
					<div class="Content-top"><div class="ContentLeft"></div><div class="ContentRight"></div>
					<h1 class="ContentTitle"><strong>我的第一个Ajax程序</strong></h1>
					<h2 class="ContentAuthor">作者:宇义 日期:2005-07-08</h2>
				</div>
			    <div class="Content-Info">
					<div class="InfoOther">字体大小: <a href="javascript:SetFont('12px')" accesskey="1">小</a> <a href="javascript:SetFont('14px')" accesskey="2">中</a> <a href="javascript:SetFont('16px')" accesskey="3">大</a></div>
					<div class="InfoAuthor"><img src="images/weather/hn2_sunny.gif" style="margin:0px 2px -6px 0px" alt=""/><img src="images/weather/hn2_t_sunny.gif" alt=""/> <img src="images/level3.gif" style="margin:0px 2px -1px 0px" alt=""/><$EditAndDel$></div>
				</div>
				<div id="logPanel" class="Content-body">
					今天做了一个Ajax应用，不刷新页面发布和更新评论内容。在IE下目前还存在问题，表现为发表评论后无法自动刷新。Firefox可以正常运行。<br/><br/><a target="_blank" href="../works/ajax/news.html">访问</a><br/><br/>ajax.asp内容为：<br/><br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent"><br/><br/>&lt;%@LANGUAGE="JAVASCRIPT" CODEPAGE="65001"%&gt;<br/>&lt;%<br/>Response.Buffer = true;<br/>Session.Timeout = 20;<br/>Session.CodePage = 65001;<br/><br/>var username = Request.QueryString("username");<br/>var content = Request.QueryString("content");<br/><br/>var xmlDom = new ActiveXObject("MSXML2.DomDocument");<br/>xmlDom.async = false;<br/>xmlDom.load(Server.MapPath("news.xml"));<br/><br/>var comments = xmlDom.documentElement.selectSingleNode("//news/comments");<br/><br/>if (Request.QueryString("act") == "doadd") {<br/>&#160;&#160;&#160;&#160;// Get last comment id<br/>&#160;&#160;&#160;&#160;var lastCommentId = parseInt(comments.lastChild.getAttributeNode("id").nodeValue);<br/>&#160;&#160;&#160;&#160;<br/>&#160;&#160;&#160;&#160;// New comment with id<br/>&#160;&#160;&#160;&#160;var newComment = xmlDom.createElement("comment");<br/>&#160;&#160;&#160;&#160;var commentId = xmlDom.createNode("attribute", "id", "");<br/>&#160;&#160;&#160;&#160;commentId.text = lastCommentId + 1;<br/>&#160;&#160;&#160;&#160;newComment.setAttributeNode(commentId);<br/>&#160;&#160;&#160;&#160;<br/>&#160;&#160;&#160;&#160;// comment's username and content<br/>&#160;&#160;&#160;&#160;var commentUsername = xmlDom.createElement("username");<br/>&#160;&#160;&#160;&#160;var commentContent = xmlDom.createElement("content");<br/>&#160;&#160;&#160;&#160;commentUsername.text = username;<br/>&#160;&#160;&#160;&#160;commentContent.text = content;<br/>&#160;&#160;&#160;&#160;newComment.appendChild(commentUsername);<br/>&#160;&#160;&#160;&#160;newComment.appendChild(commentContent);<br/>&#160;&#160;&#160;&#160;<br/>&#160;&#160;&#160;&#160;comments.appendChild(newComment);<br/>&#160;&#160;&#160;&#160;<br/>&#160;&#160;&#160;&#160;xmlDom = formatXML(xmlDom);<br/>&#160;&#160;&#160;&#160;<br/>&#160;&#160;&#160;&#160;xmlDom.save(Server.MapPath("news.xml"));<br/>&#160;&#160;&#160;&#160;<br/>}<br/><br/>// Format XML file<br/>function formatXML(objSource) {<br/>&#160;&#160;&#160;&#160;var stylesheet = new ActiveXObject("MSXML2.DomDocument");<br/>&#160;&#160;&#160;&#160;stylesheet.async = false;<br/>&#160;&#160;&#160;&#160;stylesheet.resolveExternals = false;<br/>&#160;&#160;&#160;&#160;stylesheet.loadXML("&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"<a href="http://www.w3.org/1999/XSL/Transform" target="_blank">http://www.w3.org/1999/XSL/Transform</a>\"&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "&lt;xsl:output method=\"xml\"&nbsp;&nbsp;omit-xml-declaration=\"yes\" indent=\"yes\"/&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "\t&lt;xsl:template match=\"/ | @* | node()\"&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "\t\t&lt;xsl:copy&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "\t\t\t&lt;xsl:apply-templates select=\"@* | node()\"/&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "\t\t&lt;/xsl:copy&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "\t&lt;/xsl:template&gt;\r\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ "&lt;/xsl:stylesheet&gt;\r\n");<br/><br/>&#160;&#160;&#160;&#160;var result = objSource.transformNode(stylesheet);<br/>&#160;&#160;&#160;&#160;objSource.loadXML("&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\r\n" + result);<br/><br/>&#160;&#160;&#160;&#160;return objSource;<br/>}<br/>%&gt;<br/><br/></div></div>
					<br/><br/><br/>
				</div>
				<div class="Content-body">
					[本日志由 宇义 于 2007-10-31 08:54 AM 编辑]<br/>
					<img src="images/From.gif" style="margin:0px 2px -4px 0px" alt=""/><strong>文章来自:</strong> <a href="#" target="_blank">本站原创</a><br/>
					<img src="images/icon_trackback.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>引用通告:</strong> <a href="trackback.asp?tbID=91&amp;action=view" target="_blank">查看所有引用</a> | <a href="javascript:;" title="获得引用文章的链接" onclick="getTrackbackURL(91)">我要引用此文章</a><br/>
					<img src="images/tag.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>Tags:</strong> <br/>
				</div>
				<div class="Content-bottom"><div class="ContentBLeft"></div><div class="ContentBRight"></div>评论: 2 | <a href="trackback.asp?tbID=91&amp;action=view" target="_blank">引用: 1636</a> | 查看次数: <$log_ViewNums$></div>
			</div>
		</div>
