        <%ST(A)%>
			<div id="Content_ContentList" class="content-width"><a name="body" accesskey="B" href="#body"></a>
				<div class="pageContent">
					<div style="float:right;width:180px !important;width:auto"><a href="?id=62" title="上一篇日志: HTML中marquee标记的详细说明" accesskey=","><img border="0" src="images/Cprevious.gif" alt=""/>上一篇</a> | <a href="?id=64" title="下一篇日志: 新发现一个IE的Bug" accesskey="."><img border="0" src="images/Cnext.gif" alt=""/>下一篇</a></div> 
					<img src="images/icons/12.gif" style="margin:0px 2px -4px 0px" alt=""/> <strong><a href="default.asp?cateID=22" title="查看所有资源分享的日志">资源分享</a></strong> <a href="feed.asp?cateID=22" target="_blank" title="订阅所有资源分享的日志" accesskey="O"><img border="0" src="images/rss.png" alt="订阅所有资源分享的日志" style="margin-bottom:-1px"/></a>
				</div>
				<div class="Content">
					<div class="Content-top"><div class="ContentLeft"></div><div class="ContentRight"></div>
					<h1 class="ContentTitle"><strong>ASP制作音乐连放播放器经验总结</strong></h1>
					<h2 class="ContentAuthor">作者:宇义 日期:2005-01-19</h2>
				</div>
			    <div class="Content-Info">
					<div class="InfoOther">字体大小: <a href="javascript:SetFont('12px')" accesskey="1">小</a> <a href="javascript:SetFont('14px')" accesskey="2">中</a> <a href="javascript:SetFont('16px')" accesskey="3">大</a></div>
					<div class="InfoAuthor"><img src="images/weather/hn2_sunny.gif" style="margin:0px 2px -6px 0px" alt=""/><img src="images/weather/hn2_t_sunny.gif" alt=""/> <img src="images/level3.gif" style="margin:0px 2px -1px 0px" alt=""/><$EditAndDel$></div>
				</div>
				<div id="logPanel" class="Content-body">
					今天从中午开始，一直做到晚上7点半，总算把音乐栏目的在线试听和歌词功能做好了，学习了不少知识，积累了不少经验<br/><br/>1。用javascript表格交替变换颜色:<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">function TrChange(tbody)<br/>{<br/>&#160;&#160;&#160;&#160;for(i=0;i&lt;tbody.rows.length;i++)<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(i%2==0)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tbody.rows[i].className=&quot;t1&quot;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tbody.rows[i].className=&quot;t2&quot;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;}<br/>}</div></div><br/>页面中<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">window.onload=function()<br/>{<br/>&#160;&#160;&#160;&#160;TrChange(document.getElementById(&quot;表格ID&quot;))<br/>}</div></div><br/><br/>我没有把id给table，而是在里面放了一对tbody，把id给他，这样表格表头就不会算在内而改变颜色了<br/><br/>2。音乐播放器连放实现原理<br/>用到了FSO，主要代码如下<br/><br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim FSO,TX<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set FSO=Server.createObject(&quot;Scripting.FileSystemObject&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim AsxName<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;AsxName=RandomString(1)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set TX=FSO.OpenTextFile(Server.MapPath(&quot;temp/&quot;&AsxName&&quot;.asx&quot;),2,True)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MusicName=Split(Request.Form(&quot;musicname&quot;),&quot;, &quot;,-1,1)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TX.Write(&quot;&lt;ASX VERSION=&quot;&quot;3.0&quot;&quot;&gt;&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim i<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;For i=0 to ubound(MusicName)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set CountUp=Conn.Execute(&quot;update Count_Music SET CountListen=CountListen+1 where MusicName='&quot;&CheckStr(MusicName(i))&&quot;'&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TX.Write(&quot;&lt;ENTRY&gt;&lt;ref href=&quot;&quot;<a href="http://localhost/resource/music/listen/" target="_blank">http://localhost/resource/music/listen/</a>&quot;&MusicName(i)&&quot;.wma&quot;&quot;/&gt;&lt;/ENTRY&gt;&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Next<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TX.Write(&quot;&lt;/ASX&gt;&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MusicURL=&quot;<a href="http://localhost/temp/" target="_blank">http://localhost/temp/</a>&quot;&AsxName&&quot;.asx&quot; </div></div><br/><br/>原理：将传来的歌曲名写进一个asx文件，紧接着播放这个asx播放列表。<br/>方法：接收checkbox来的字段，用<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">MusicName=Split(Request.Form(&quot;musicname&quot;),&quot;, &quot;,-1,1)</div></div><br/>将字段拆成数组，用<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">AsxName=RandomString(1)</div></div><br/>生成文件名，本来想就用一个文件名的，不停更新就是了，可是播放器有记忆功能，如果重复播放都是一样名字的Asx文件，会导致播放的歌曲不正确，<br/>于是使用随即生成文件名，为了节省磁盘占用空间，文件名只有1个字母，但这样也能基本保证不会发生两次连续生成文件名一样的问题。随机文件名函数如下<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">'Generate random string<br/>Function RandomString(Length)<br/>&#160;&#160;&#160;&#160;Dim i, tempS<br/>&#160;&#160;&#160;&#160;tempS = &quot;abcdefghijklmnopqrstuvwxyz1234567890&quot; <br/>&#160;&#160;&#160;&#160;RandomString = &quot;&quot;<br/>&#160;&#160;&#160;&#160;If isNumeric(Length) = False Then <br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Exit Function <br/>&#160;&#160;&#160;&#160;End If <br/>&#160;&#160;&#160;&#160;For i = 1 to Length <br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Randomize <br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;RandomString = RandomString & Mid(tempS,Int((Len(tempS) * Rnd) + 1),1)<br/>&#160;&#160;&#160;&#160;Next <br/>End Function </div></div><br/>将asx代码写进asx文件中，同时给计数器加一<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TX.Write(&quot;&lt;ASX VERSION=&quot;&quot;3.0&quot;&quot;&gt;&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim i<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;For i=0 to ubound(MusicName)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set CountUp=Conn.Execute(&quot;update Count_Music SET CountListen=CountListen+1 where MusicName='&quot;&CheckStr(MusicName(i))&&quot;'&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TX.Write(&quot;&lt;ENTRY&gt;&lt;ref href=&quot;&quot;<a href="http://localhost/resource/music/listen/" target="_blank">http://localhost/resource/music/listen/</a>&quot;&MusicName(i)&&quot;.wma&quot;&quot;/&gt;&lt;/ENTRY&gt;&quot;)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Next<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TX.Write(&quot;&lt;/ASX&gt;&quot;)<br/></div></div><br/>其中用到 ubound(MusicName) 是数组成员的个数，最后给出asx文件的地址，供下面的代码调用并播放<br/><div class="UBBPanel"><div class="UBBTitle"><img src="images/code.gif" style="margin:0px 2px -3px 0px" alt="程序代码"/> 程序代码</div><div class="UBBContent">MusicURL=&quot;<a href="http://localhost/temp/" target="_blank">http://localhost/temp/</a>&quot;&AsxName&&quot;.asx&quot;</div></div>
					<br/><br/><br/>
				</div>
				<div class="Content-body">
					
					<img src="images/From.gif" style="margin:0px 2px -4px 0px" alt=""/><strong>文章来自:</strong> <a href="#" target="_blank">本站原创</a><br/>
					<img src="images/icon_trackback.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>引用通告:</strong> <a href="trackback.asp?tbID=63&amp;action=view" target="_blank">查看所有引用</a> | <a href="javascript:;" title="获得引用文章的链接" onclick="getTrackbackURL(63)">我要引用此文章</a><br/>
					<img src="images/tag.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>Tags:</strong> <br/>
				</div>
				<div class="Content-bottom"><div class="ContentBLeft"></div><div class="ContentBRight"></div>评论: 2 | <a href="trackback.asp?tbID=63&amp;action=view" target="_blank">引用: 818</a> | 查看次数: <$log_ViewNums$></div>
			</div>
		</div>
